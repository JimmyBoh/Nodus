{
  "name": "lactate",
  "version": "0.10.5",
  "description": "Simple assets server",
  "keywords": [
    "static",
    "assets",
    "cache"
  ],
  "repository": {
    "type": "git",
    "url": "git://github.com/Weltschmerz/Lactate.git"
  },
  "author": {
    "name": "Weltschmerz",
    "email": "chlavois@gmail.com"
  },
  "dependencies": {
    "mime": "1.2.7",
    "suckle": "0.5.2",
    "expire": "0.4.5",
    "abridge": "0.2.9",
    "fraction": "0.0.1",
    "optimist": "0.3.4"
  },
  "devDependencies": {
    "mocha": "1.5.0",
    "should": "1.2.0"
  },
  "main": "index.js",
  "bin": {
    "lactate": "bin/lactate"
  },
  "scripts": {
    "test": "make test"
  },
  "engines": {
    "node": ">= 0.6.0"
  },
  "readme": "# Lactate\n\n`npm install -g lactate`\n\nAn exceedingly fast static file handler, with a few electives.\n\n### Features\n\n* In-memory caching\n* Robust cache-control setting\n* Automatic gzipping\n* Automatic minification\n* Custom 404 pages\n* Custom response headers\n* Middleware export\n* Asset bundling\n\n### Comparison\n\nLactate caches files in memory without hitting the file system for each request, watches files for efficient udpates, and streams gzipped files directly to the response.  [Preliminary benchmarks](https://github.com/Weltschmerz/Lactate/blob/master/benchmark/new/results.md) show that Lactate has a significant advantage over  most worthy competitors on the [node modules wiki](https://github.com/joyent/node/wiki/Modules#wiki-web-frameworks-static)\n\n![Bench](http://i.imgur.com/b3xJU.jpg)\n\n* `ab -c 100 -n 10000`\n* `node` v0.8.7\n* `jquery.min.js` ~100kb\n\n*See /benchmark for details*\n\n## Using Lactate\n\n### Global executable\n\nIf installed globally with `npm install -g lactate`, you will have the `lactate` command at your disposal. This will run lactate static file server in the current working directory, utilizing the `cluster` module for multiple CPU cores. All [options](https://github.com/Weltschmerz/Lactate#options) are available.\n\n```code\nwltsmrz@home:~$ lactate --help\nUsage: lactate [options]\n\nOptions:\n--from, -f                        Public path                   [default: \"\"]\n--cache, -c                       Store assets in-memory        [default: true]\n--watch_files, --watch-files, -w  Watch files for cache update  [default: true]\n--subdirs, -s                     Serve subdirectories          [default: true]\n--max_age, --max-age, -M          Client-side caching max-age   [default: 172800]\n--gzip, -g                        Gzip text assets              [default: true]\n--minify, -m                      Minify text assets            [default: false]\n--bundle, -b                      Bundle text assets            [default: false]\n--rebundle, -r                    Rebundle assets if modified   [default: true]\n--headers, -H                     Custom response headers       [default: \"\"]\n--debug, -d                       Log HTTP info                 [default: true]\n--quiet, -q                       Prevent all log output        [default: false]\n```\n\n### Programmatic lactating\n\nLactate can be used with either plain node, or with Express. With Express, Lactate is a drop-in replacement for `static` middleware, but with far more ability. The examples below use Express 2.x API for simplicity. See the [examples](https://github.com/Weltschmerz/Lactate/tree/master/example) for various examples.\n\n```js\nvar lactate = require('lactate');\nvar express = require('express');\n\nvar app = express.createServer();\napp.use(lactate.static(__dirname + '/files'));\n```\n\n## Testing Lactate\n\nIf installed locally (without -g flag to npm install):\n\n1. `cd` into `~/node_modules/lactate`\n2. `npm install ./` to install devDependencies\n3. `make test` to run mocha test\n\nIf installed globally, simply run `npm test lactate`.\n\n##The varieties of Lactate experience\n\nIn the general case, the `Lactate` method returns an object with the methods `serve` `set` and `get`, importantly. However, there are more convenient methods exported by Lactate. They follow.\n\n###Serving individual files\n\nTo serve an individual file, use the `file` method.\n\n```js\n\n  app.get('/', function(req, res) {\n    Lactate.file('land.html', req, res)\n  })\n```\n\nAn optional fourth argument is for Lactate settings.\n\n```js\n  var options = {\n    max_age:'two days',\n    minify:true,\n    from:'scripts'\n  }\n\n  app.get('/', function(req, res) {\n    Lactate.file('land.html', req, res, options);\n  })\n```\n\n###Serving directories\n\nThe `dir` method allows you to namespace a directory, for convenience.\n\n```js\nvar images = Lactate.dir('images');\n\napp.get('/images/:image', function(req, res) {\n  images.serve(req.params.image, req, res)\n})\n```\n\nPass a second argument to `dir` for options:\n\n```js\nvar options = { cache:false };\nvar images = Lactate.dir('assets/images', options);\nimages.maxAge('five days');\n```\n\n###Middleware export\n\nFor maximum convenience, you may use the `toMiddleware` method on directories.\n\n```js\nvar images = Lactate.dir('images', {\n  from:'images',\n  cache:false,\n  max_age:'two years',\n  debug:true\n}).toMiddleware()\n\napp.use(images) //That's it!\n```\n\nYou may also pass additional options to the `toMiddleware` function.\n\n```js\nvar images = Lactate.dir('images');\nimages.set('cache', false);\n\nvar middleware = images.toMiddleware({\n  from:'images'\n})\n\napp.use(middleware)\n```\n\n###Custom 404 pages\n\nUse the `not_found` option for defining custom 404 pages or handler functions.\n\nStrings will be treated as ordinary file paths, and as such will abide rules for gzipping and in-memory caching. Note that `notFound` paths will be relative to the `root` setting (by default `process.cwd()`).\n\n```js\nvar lactate = Lactate.Lactate({\n    not_found:'pages/404.html'\n})\n\nlactate.set('not_found', 'pages/not_found.html');\n```\n\nFunctions allow you to fully customize your 404 handling.\n\n```js\nvar lactate = Lactate.Lactate({\n  not_found:function(req, res) { }\n});\n```\n\nA special configuration method is provided:\n\n```js\nlactate.notFound(function(req, res) {\n    res.writeHead(404)\n    res.end('My custom 404 thingy')\n})\n```\n\n###Custom response headers\n\nExtend response headers with `headers` option.\n\n```js\nvar options = {\n    headers: {\n        server:'Lactate'\n    }\n};\n\nlactate.set(options);\nlactate.set('headers', options.headers);\nlactate.headers(options.headers);\nlactate.setHeader('server', options.headers.server);\n\napp.get('/', function(req, res) {\n    lactate.serve('pages/land.html', req, res);\n});\n```\n\nYou may also use a function for dynamic header setting:\n\n```js\n  lactate.setHeader('server', function(req, res) {\n    return 'lactate';\n  });\n```\n\n###Bundling assets for request optimization\n\nLactate directories have an additional method for combining and minifying text assets, to reduce the number of necessary requests.\n\n```js\nvar assets = lactate.dir('assets', {\n    from:'assets',\n    minify:true\n});\n\nassets.bundle('js', 'common.js', function(err, data) { });\n//assets.bundleJS('common.js', function(){});\nassets.bundleCSS('common.css');\napp.use(assets.toMiddleware());\n```\n\nNow, requesting `/assets/common.js` will result with a combined and minified (and by default gzipped) script of all the scripts contained in that directory. This function does actually write the bundled files to disk.\n\nMore on this later\n\n##Options\n\nOptions can be passed to the initialization function or using the `set` method.\n\n### Setting options\n\n```js\n\n//Passing to initialization function\nvar lactate = require('lactate').Lactate({\n  max_age:'two days'\n})\n\n//Set method\nlactate.set('max_age', null)\n\n//Either function accepts (key, value) or an object.\n\n```\n\n### Options available\n\n+ `root` **string**\n\nLocal directory from which to serve files. By default, the current working directory.\n\n+ `from` **string**\n\nPublic directory exposed to clients. If set, only requests from /*directory* will complete. Contrast this with the `root` option which is the location of files on the serving machine, not necessarily the requested path.\n\n+ `subdirs` **boolean**\n\nBy default subdirectories are served. To disable this, set `subdirs` to false.\n\n+ `cache` **boolean**\n\nKeep files in-memory. Enabled by default, and no great reason to disable, unless you are serving fairly large files or run a low-traffic operation.\n\n+ `gzip` **boolean**\n\nIf false, disables automatic gzipping for text files (HTML, JS, CSS). Enabled by default.\n\n+ `minify` **boolean**\n\nIf true, will automatically minify JavaScript and CSS using [Abridge](https://github.com/Weltschmerz/Abridge). Disabled by default.\n\n+ `watch_files` **boolean**\n\nDetermines whether Lactate will watch files to update its cache. If this is disabled, then your file cache will not update automatically as files are modified on the server.\n\n+ `headers` **object** or **string** or **function**\n\nSets custom response headers. If the option value is a function, it is a callback which is give (req, res) arguments. This function should return the header value; it is a mapping function.\n\n+ `max_age` **number** or **string**\n\nPass this function a number (of seconds) or a string and appropriate headers will be set for client-side caching. Lactate comes with expiration defaults, such as 'two days' or '5 years and sixteen days' See [Expire](https://github.com/Weltschmerz/Expire) for details.\n\n```js\nlactate.set('max_age', 87500)\n//87500 seconds\nlactate.set('max_age', 'two days')\n//172800 seconds\nlactate.set'max_age', 'five weeks and one minute and ten seconds')\n//3024070 seconds\nlactate.set('max_age', 'one year and 2 months and seven weeks and 16 seconds')\n//41050028 seconds\n```\n\n+ `not_found` **string** or **function**\n\nFor custom 404 handling. Functions are supplied the response for 100% custom response handling. Otherwise, if set to a string, this option will be treated as an ordinary file path and abide rules for gzipping / in-memory cache.\n\n+ `debug` **boolean**\n\nColored status / msg / path logging, for debugging purposes.\n\n###Special options methods\n\nLactate has some special methods to reduce visual clutter:\n\n```js\nlactate.maxAge('two days');\n```\n\nis equivalent to:\n\n```js\nlactate.set('max_age', 'two days');\n```\n\nSimilarly, the `headers` method is for setting custom response headers.\n\n## License\n\nMIT License\n\nCopyright 2012 Brandon Wilson\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
  "_id": "lactate@0.10.5",
  "dist": {
    "shasum": "0803203e143cce6d431b08787ca68954f687d878"
  },
  "_from": "lactate"
}
